-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.products
(
    "ProductId" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "ProductName" character varying(30) NOT NULL,
    "ProductPrice" double precision NOT NULL,
    PRIMARY KEY ("ProductId")
);

CREATE TABLE public.productsinstorage
(
    "Id" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "ProductId" integer NOT NULL,
    "StorageId" integer NOT NULL,
    "ProductQuantity" integer NOT NULL,
    PRIMARY KEY ("Id")
);

CREATE TABLE public.storages
(
    "StorageId" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "StorageName" character varying(30) NOT NULL,
    "StorageKeeper" character varying(30) NOT NULL,
    "Marcup" double precision NOT NULL,
    PRIMARY KEY ("StorageId")
);

CREATE TABLE public.users
(
    "Login" character varying(30) NOT NULL,
    "Password" character varying(20) NOT NULL,
    PRIMARY KEY ("Login", "Password")
);

CREATE TABLE public.waybillpositions
(
    "WaybillPositionId" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "WaybillId" integer NOT NULL,
    "ProductId" integer NOT NULL,
    "ProductQuantity" integer NOT NULL,
    "Customer" character varying(30),
    PRIMARY KEY ("WaybillPositionId")
);

CREATE TABLE public.waybills
(
    "WaybillId" integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "StorageId" integer NOT NULL,
    "WaybillType" integer NOT NULL,
    "Date" date NOT NULL,
    PRIMARY KEY ("WaybillId")
);

ALTER TABLE public.productsinstorage
    ADD FOREIGN KEY ("ProductId")
    REFERENCES public.products ("ProductId")
    NOT VALID;


ALTER TABLE public.productsinstorage
    ADD FOREIGN KEY ("StorageId")
    REFERENCES public.storages ("StorageId")
    NOT VALID;


ALTER TABLE public.waybillpositions
    ADD FOREIGN KEY ("WaybillId")
    REFERENCES public.waybills ("WaybillId")
    NOT VALID;


ALTER TABLE public.waybillpositions
    ADD FOREIGN KEY ("ProductId")
    REFERENCES public.products ("ProductId")
    NOT VALID;


ALTER TABLE public.waybills
    ADD FOREIGN KEY ("StorageId")
    REFERENCES public.storages ("StorageId")
    NOT VALID;

END;